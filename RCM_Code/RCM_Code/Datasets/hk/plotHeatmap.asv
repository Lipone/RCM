%heatmap
% 创建示例数据矩阵

threshold=0.32;
data = squeeze(INDEX(:,:,6)); 
% 去除第一行和第一列
data = data(2:end, 2:end);
for i = 1:min(size(data))
    data(i, i) = 0;
end
% xname = {'CD','RSP','NO2','SO2','O3'};
% yname = {'CD','RSP','NO2','SO2','O3'};
% h = heatmap(xname,yname,data);
% % 指定阈值
% % % 将超过阈值的单元格用红色虚线框加粗
% % for i = 1:size(data, 1)
% %     for j = 1:size(data, 2)
% %         if data(i, j) > threshold
% %             % 使用 plot 函数模拟虚线框
% %             plot([i-0.5, i+0.5, i+0.5, i-0.5, i-0.5], ...
% %                  [j-0.5, j-0.5, j+0.5, j+0.5, j-0.5], ...
% %                  'r--', 'LineWidth', 2);
% %         end
% %     end
% % end



% 创建热力图
imagesc(data);
colormap('jet');
colorbar;



rectangle('Position', [0.5, 0.5, num_cols, num_rows], 'EdgeColor', 'k', 'LineWidth', 2);
hold on;


% 创建一个矩阵，标识哪些数据超出阈值
exceed_threshold = data > threshold;

% 获取矩阵的尺寸
[num_rows, num_cols] = size(data);

% 添加红色虚线网格，设置较粗的边框
for i = 1:num_rows
    for j = 1:num_cols
        if exceed_threshold(i, j)
            if i~=3
            data(i, j)
            rectangle('Position', [j-0.5, i-0.5, 1, 1], ...
                'EdgeColor', 'r', 'LineStyle', '--', 'LineWidth', 5);
            end
            
        end
    end
end

hold on;
plot([0.5, num_cols+0.5], [0.5, num_rows+0.5], '--', 'Color', [0.5, 0.5, 0.5], 'LineWidth', 3);
hold off


% 隐藏 x 轴和 y 轴刻度
set(gca, 'XTick', []);
set(gca, 'YTick', []);
% 设置其余坐标区属性
set(gca,'Colormap',...
    [1 1 1;0.999930071722217 0.999957323183412 0.999893565047786;0.999860143444434 0.999914646366824 0.999787130095572;0.999790215166651 0.999871969550235 0.999680695143358;0.999720286888868 0.999829292733647 0.999574260191144;0.999650358611085 0.999786615917059 0.99946782523893;0.999580430333302 0.999743939100471 0.999361390286716;0.999510502055519 0.999701262283883 0.999254955334502;0.999440573777735 0.999658585467294 0.999148520382288;0.999370645499952 0.999615908650706 0.999042085430074;0.999300717222169 0.999573231834118 0.99893565047786;0.999230788944386 0.99953055501753 0.998829215525646;0.999160860666603 0.999487878200942 0.998722780573432;0.99909093238882 0.999445201384353 0.998616345621218;0.999021004111037 0.999402524567765 0.998509910669004;0.998951075833254 0.999359847751177 0.99840347571679;0.998881147555471 0.999317170934589 0.998297040764576;0.998811219277688 0.999274494118001 0.998190605812363;0.998741290999905 0.999231817301413 0.998084170860149;0.998671362722122 0.999189140484824 0.997977735907935;0.998601434444339 0.999146463668236 0.997871300955721;0.998531506166556 0.999103786851648 0.997764866003507;0.998461577888772 0.99906111003506 0.997658431051293;0.998391649610989 0.999018433218472 0.997551996099079;0.998321721333206 0.998975756401883 0.997445561146865;0.998251793055423 0.998933079585295 0.997339126194651;0.99818186477764 0.998890402768707 0.997232691242437;0.998111936499857 0.998847725952119 0.997126256290223;0.998042008222074 0.998805049135531 0.997019821338009;0.997972079944291 0.998762372318942 0.996913386385795;0.997902151666508 0.998719695502354 0.996806951433581;0.997832223388725 0.998677018685766 0.996700516481367;0.997762295110942 0.998634341869178 0.996594081529153;0.997692366833159 0.99859166505259 0.996487646576939;0.997622438555375 0.998548988236001 0.996381211624725;0.997552510277592 0.998506311419413 0.996274776672511;0.997482581999809 0.998463634602825 0.996168341720297;0.997412653722026 0.998420957786237 0.996061906768083;0.997342725444243 0.998378280969648 0.99595547181587;0.99727279716646 0.99833560415306 0.995849036863656;0.997202868888677 0.998292927336472 0.995742601911442;0.997132940610894 0.998250250519884 0.995636166959228;0.997063012333111 0.998207573703295 0.995529732007014;0.996993084055328 0.998164896886707 0.9954232970548;0.996923155777545 0.998122220070119 0.995316862102586;0.996853227499762 0.998079543253531 0.995210427150372;0.996783299221979 0.998036866436942 0.995103992198158;0.996713370944196 0.997994189620354 0.994997557245944;0.996643442666413 0.997951512803766 0.99489112229373;0.99657351438863 0.997908835987178 0.994784687341516;0.996503586110846 0.99786615917059 0.994678252389302;0.996433657833063 0.997823482354001 0.994571817437088;0.99636372955528 0.997780805537413 0.994465382484874;0.996293801277497 0.997738128720825 0.994358947532661;0.996223872999714 0.997695451904237 0.994252512580447;0.996153944721931 0.997652775087648 0.994146077628233;0.996084016444148 0.99761009827106 0.994039642676019;0.996014088166365 0.997567421454472 0.993933207723805;0.995944159888582 0.997524744637884 0.993826772771591;0.995874231610799 0.997482067821296 0.993720337819377;0.995804303333016 0.997439391004707 0.993613902867163;0.995734375055233 0.997396714188119 0.993507467914949;0.995664446777449 0.997354037371531 0.993401032962735;0.995594518499666 0.997311360554943 0.993294598010521;0.995524590221883 0.997268683738355 0.993188163058307;0.9954546619441 0.997226006921766 0.993081728106093;0.995384733666317 0.997183330105178 0.992975293153879;0.995314805388534 0.99714065328859 0.992868858201665;0.995244877110751 0.997097976472002 0.992762423249451;0.995174948832968 0.997055299655414 0.992655988297237;0.995105020555185 0.997012622838825 0.992549553345023;0.995035092277402 0.996969946022237 0.992443118392809;0.994965163999618 0.996927269205649 0.992336683440595;0.994895235721835 0.996884592389061 0.992230248488381;0.994825307444052 0.996841915572473 0.992123813536167;0.994755379166269 0.996799238755884 0.992017378583953;0.994685450888486 0.996756561939296 0.991910943631739;0.994615522610703 0.996713885122708 0.991804508679526;0.99454559433292 0.99667120830612 0.991698073727312;0.994475666055137 0.996628531489532 0.991591638775098;0.994405737777354 0.996585854672943 0.991485203822884;0.99433580949957 0.996543177856355 0.99137876887067;0.994265881221787 0.996500501039767 0.991272333918456;0.994195952944004 0.996457824223179 0.991165898966242;0.994126024666221 0.996415147406591 0.991059464014028;0.99405950752394 0.996374552385934 0.990958221010702;0.993984442477401 0.99632874062959 0.99084396759428;0.993909377430863 0.996282928873247 0.990729714177857;0.993977539944386 0.996324528054294 0.990833461533;0.995500725965127 0.997254119522834 0.993151840255744;0.990897544176298 0.994010561751081 0.988562808380828;0.98629436238747 0.990767003979327 0.983973776505911;0.981691180598642 0.987523446207574 0.979384744630995;0.977087998809813 0.98427988843582 0.974795712756078;0.972484817020985 0.981036330664067 0.970206680881162;0.967881635232156 0.977792772892313 0.965617649006245;0.963278453443328 0.97454921512056 0.961028617131329;0.958675271654499 0.971305657348807 0.956439585256412;0.954072089865671 0.968062099577053 0.951850553381496;0.949468908076843 0.9648185418053 0.947261521506579;0.944865726288014 0.961574984033546 0.942672489631663;0.940262544499186 0.958331426261793 0.938083457756746;0.935659362710357 0.955087868490039 0.93349442588183;0.931056180921529 0.951844310718286 0.928905394006913;0.9264529991327 0.948600752946533 0.924316362131997;0.921849817343872 0.945357195174779 0.91972733025708;0.917246635555044 0.942113637403026 0.915138298382164;0.912643453766215 0.938870079631272 0.910549266507247;0.908040271977387 0.935626521859519 0.905960234632331;0.903437090188558 0.932382964087765 0.901371202757414;0.89883390839973 0.929139406316012 0.896782170882498;0.894230726610901 0.925895848544259 0.892193139007581;0.889627544822073 0.922652290772505 0.887604107132665;0.885024363033245 0.919408733000752 0.883015075257748;0.880421181244416 0.916165175228998 0.878426043382832;0.875817999455588 0.912921617457245 0.873837011507915;0.871214817666759 0.909678059685491 0.869247979632999;0.866611635877931 0.906434501913738 0.864658947758083;0.862008454089102 0.903190944141985 0.860069915883166;0.857405272300274 0.899947386370231 0.85548088400825;0.852802090511446 0.896703828598478 0.850891852133333;0.848198908722617 0.893460270826724 0.846302820258417;0.843595726933789 0.890216713054971 0.8417137883835;0.83899254514496 0.886973155283217 0.837124756508584;0.834389363356132 0.883729597511464 0.832535724633667;0.829786181567303 0.880486039739711 0.827946692758751;0.825182999778475 0.877242481967957 0.823357660883834;0.820579817989647 0.873998924196204 0.818768629008918;0.815976636200818 0.87075536642445 0.814179597134001;0.81137345441199 0.867511808652697 0.809590565259085;0.806770272623161 0.864268250880943 0.805001533384168;0.802167090834333 0.86102469310919 0.800412501509252;0.797563909045504 0.857781135337437 0.795823469634335;0.792960727256676 0.854537577565683 0.791234437759419;0.788357545467848 0.85129401979393 0.786645405884502;0.783754363679019 0.848050462022176 0.782056374009586;0.779151181890191 0.844806904250423 0.777467342134669;0.774548000101362 0.841563346478669 0.772878310259753;0.769944818312534 0.838319788706916 0.768289278384836;0.765341636523705 0.835076230935163 0.76370024650992;0.760738454734877 0.831832673163409 0.759111214635003;0.756135272946049 0.828589115391656 0.754522182760087;0.75153209115722 0.825345557619902 0.749933150885171;0.746928909368392 0.822101999848149 0.745344119010254;0.742325727579563 0.818858442076395 0.740755087135337;0.737722545790735 0.815614884304642 0.736166055260421;0.733119364001906 0.812371326532889 0.731577023385505;0.728516182213078 0.809127768761135 0.726987991510588;0.72391300042425 0.805884210989382 0.722398959635672;0.719309818635421 0.802640653217628 0.717809927760755;0.714706636846593 0.799397095445875 0.713220895885839;0.710103455057764 0.796153537674121 0.708631864010922;0.705500273268936 0.792909979902368 0.704042832136006;0.700897091480107 0.789666422130615 0.699453800261089;0.696293909691279 0.786422864358861 0.694864768386173;0.691690727902451 0.783179306587108 0.690275736511256;0.687087546113622 0.779935748815354 0.68568670463634;0.682484364324794 0.776692191043601 0.681097672761423;0.677881182535965 0.773448633271847 0.676508640886507;0.673278000747137 0.770205075500094 0.67191960901159;0.668674818958308 0.766961517728341 0.667330577136674;0.66407163716948 0.763717959956587 0.662741545261757;0.659468455380652 0.760474402184834 0.658152513386841;0.654865273591823 0.75723084441308 0.653563481511924;0.650262091802995 0.753987286641327 0.648974449637008;0.645658910014166 0.750743728869573 0.644385417762091;0.641055728225338 0.74750017109782 0.639796385887175;0.636452546436509 0.744256613326067 0.635207354012258;0.631849364647681 0.741013055554313 0.630618322137342;0.627246182858853 0.73776949778256 0.626029290262425;0.622643001070024 0.734525940010806 0.621440258387509;0.618039819281196 0.731282382239053 0.616851226512592;0.613436637492367 0.728038824467299 0.612262194637676;0.608833455703539 0.724795266695546 0.60767316276276;0.604230273914711 0.721551708923793 0.603084130887843;0.599627092125882 0.718308151152039 0.598495099012927;0.595023910337054 0.715064593380286 0.59390606713801;0.590420728548225 0.711821035608532 0.589317035263093;0.585817546759397 0.708577477836779 0.584728003388177;0.581214364970568 0.705333920065025 0.580138971513261;0.57661118318174 0.702090362293272 0.575549939638344;0.572008001392911 0.698846804521519 0.570960907763428;0.567404819604083 0.695603246749765 0.566371875888511;0.562801637815254 0.692359688978012 0.561782844013595;0.558198456026426 0.689116131206258 0.557193812138678;0.553595274237598 0.685872573434505 0.552604780263762;0.548992092448769 0.682629015662751 0.548015748388845;0.544388910659941 0.679385457890998 0.543426716513929;0.539785728871113 0.676141900119245 0.538837684639012;0.535182547082284 0.672898342347491 0.534248652764096;0.530579365293456 0.669654784575738 0.529659620889179;0.525976183504627 0.666411226803984 0.525070589014263;0.521373001715799 0.663167669032231 0.520481557139346;0.51676981992697 0.659924111260477 0.51589252526443;0.512166638138142 0.656680553488724 0.511303493389513;0.507563456349313 0.653436995716971 0.506714461514597;0.502960274560485 0.650193437945217 0.50212542963968;0.498357092771657 0.646949880173464 0.497536397764764;0.493753910982828 0.64370632240171 0.492947365889847;0.489150729194 0.640462764629957 0.488358334014931;0.484547547405171 0.637219206858203 0.483769302140014;0.479944365616343 0.63397564908645 0.479180270265098;0.475341183827514 0.630732091314697 0.474591238390181;0.470738002038686 0.627488533542943 0.470002206515265;0.466134820249858 0.62424497577119 0.465413174640348;0.461531638461029 0.621001417999436 0.460824142765432;0.456928456672201 0.617757860227683 0.456235110890515;0.452325274883372 0.614514302455929 0.451646079015599;0.447722093094544 0.611270744684176 0.447057047140683;0.443118911305715 0.608027186912423 0.442468015265766;0.438515729516887 0.604783629140669 0.43787898339085;0.433912547728059 0.601540071368916 0.433289951515933;0.42930936593923 0.598296513597162 0.428700919641017;0.424706184150402 0.595052955825409 0.4241118877661;0.420103002361573 0.591809398053655 0.419522855891184;0.415499820572745 0.588565840281902 0.414933824016267;0.410896638783916 0.585322282510149 0.410344792141351;0.406293456995088 0.582078724738395 0.405755760266434;0.40169027520626 0.578835166966642 0.401166728391518;0.397087093417431 0.575591609194888 0.396577696516601;0.392483911628603 0.572348051423135 0.391988664641685;0.387880729839774 0.569104493651381 0.387399632766768;0.383277548050946 0.565860935879628 0.382810600891852;0.378674366262117 0.562617378107874 0.378221569016935;0.374071184473289 0.559373820336121 0.373632537142019;0.369468002684461 0.556130262564368 0.369043505267102;0.364864820895632 0.552886704792614 0.364454473392186;0.360261639106804 0.549643147020861 0.359865441517269;0.355658457317975 0.546399589249107 0.355276409642353;0.351055275529147 0.543156031477354 0.350687377767436;0.346452093740318 0.5399124737056 0.34609834589252;0.34184891195149 0.536668915933847 0.341509314017603;0.337245730162662 0.533425358162094 0.336920282142687;0.332642548373833 0.53018180039034 0.33233125026777;0.328039366585005 0.526938242618587 0.327742218392854;0.323436184796176 0.523694684846833 0.323153186517938;0.318833003007348 0.52045112707508 0.318564154643021;0.31422982121852 0.517207569303326 0.313975122768104;0.309626639429691 0.513964011531573 0.309386090893188;0.305023457640863 0.51072045375982 0.304797059018271;0.300420275852034 0.507476895988066 0.300208027143355;0.295817094063206 0.504233338216313 0.295618995268439;0.291213912274377 0.500989780444559 0.291029963393522;0.286610730485549 0.497746222672806 0.286440931518606;0.282007548696721 0.494502664901053 0.281851899643689;0.277404366907892 0.491259107129299 0.277262867768773;0.272801185119064 0.488015549357546 0.272673835893856;0.268198003330235 0.484771991585792 0.26808480401894;0.263594821541407 0.481528433814039 0.263495772144023;0.258991639752578 0.478284876042285 0.258906740269107;0.25438845796375 0.475041318270532 0.25431770839419;0.249785276174922 0.471797760498778 0.249728676519274;0.245182094386093 0.468554202727025 0.245139644644357;0.240578912597265 0.465310644955272 0.240550612769441;0.235975730808436 0.462067087183518 0.235961580894524;0.231372549019608 0.458823529411765 0.231372549019608],...
    'Layer','bottom','XTick',[],'YTick',[]);








